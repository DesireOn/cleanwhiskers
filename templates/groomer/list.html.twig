{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/blocks/hero.css') }}">
    <link rel="stylesheet" href="{{ asset('styles/blocks/sort-dropdown.css') }}">
    {# Reuse homepage groomer card/grid styles #}
    <link rel="stylesheet" href="{{ asset('styles/blocks/groomer-card.css') }}">
    <link rel="stylesheet" href="{{ asset('css/components/card-groomer.css') }}">
    <link rel="stylesheet" href="{{ asset('styles/blocks/city-list.css') }}">
    <link rel="stylesheet" href="{{ asset('styles/blocks/how-it-works.css') }}">
    <link rel="stylesheet" href="{{ asset('styles/blocks/social-proof.css') }}">
    <link rel="stylesheet" href="{{ asset('styles/blocks/faq.css') }}">
    {# benefits-section styles now bundled via assets/app.js import #}
    <style>
      .reveal-on-scroll{opacity:0;transform:translateY(20px);transition:opacity .6s ease,transform .6s ease}
      .reveal-in{opacity:1;transform:none}
      @media (prefers-reduced-motion: reduce){.reveal-on-scroll{opacity:1;transform:none;transition:none}}
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="module" src="{{ asset('js/section-reveal.js') }}" defer></script>
    <script type="module" src="{{ asset('js/faq-accordion.js') }}" defer></script>
    <script type="module" src="{{ asset('js/form-enhance.js') }}" defer></script>
    {# CAPTCHA widget script (if enabled) #}
    {% if captcha_provider is defined and captcha_provider|lower != 'none' and captcha_provider|length > 0 %}
        {% if captcha_provider|lower in ['recaptcha', 'google'] %}
            <script src="https://www.google.com/recaptcha/api.js" async defer></script>
        {% elseif captcha_provider|lower == 'hcaptcha' %}
            <script src="https://hcaptcha.com/1/api.js" async defer></script>
        {% endif %}
    {% endif %}
{% endblock %}

{% block body %}
  <div class="landing-page-container">
    <section class="hero hero-section" aria-labelledby="lp-hero-title">
      <img
        class="hero__image hero-image"
        src="{{ asset('images/hero-placeholder.jpg') }}"
        alt="Happy pet after a grooming session"
        fetchpriority="high"
      />

      <div class="hero__container hero__inner">
        <h1 id="lp-hero-title" class="hero__title">
          {{ 'The Easiest Way to Book' }} {{ service.name }} {{ 'in' }} {{ city.name }}
        </h1>

        <p class="hero__subtitle sub-headline">
          Our network of vetted, insured groomers is ready to pamper your pet. Get a free, no-obligation quote in 60 seconds.
        </p>

        <form class="hero__form lead-capture-form" method="post" action="/lead" novalidate>
          <input type="hidden" name="city" value="{{ city.slug }}" />
          <input type="hidden" name="service" value="{{ service.slug }}" />

          <div class="hero__field">
            <label class="hero__label" for="lead-full-name">Full Name</label>
            <input class="hero__input hero__input--icon hero__input--icon-name" type="text" id="lead-full-name" name="full_name" placeholder="Your full name" autocomplete="name" required />
          </div>

          <div class="hero__field">
            <label class="hero__label" for="lead-phone">Phone Number</label>
            <input class="hero__input hero__input--icon hero__input--icon-phone" type="tel" id="lead-phone" name="phone" placeholder="(555) 123-4567" inputmode="tel" autocomplete="tel" required pattern="^[0-9+().\\s-]{7,}$" title="Use digits and symbols like + ( ) -" aria-describedby="lead-phone-hint" />
            <div id="lead-phone-hint" class="field-hint">We’ll only use this to connect you with a groomer. No spam.</div>
          </div>

          <div class="hero__field">
            <label class="hero__label" for="lead-email">Email</label>
            <input class="hero__input" type="email" id="lead-email" name="email" placeholder="you@example.com" autocomplete="email" aria-describedby="lead-email-hint" />
            <div id="lead-email-hint" class="field-hint">Optional — helpful for sending quotes and updates.</div>
          </div>

          <div class="hero__field">
            <label class="hero__label" for="lead-pet-type">Pet Type</label>
            <select class="hero__input hero__input--icon hero__input--icon-paw" id="lead-pet-type" name="pet_type" required>
              <option value="" disabled selected>Select pet type</option>
              <option value="dog">Dog</option>
              <option value="cat">Cat</option>
            </select>
          </div>

          {# Breed/Size field removed per request #}

          {# Honeypot field (hidden) #}
          <div class="visually-hidden" aria-hidden="true" style="position:absolute; left:-10000px;">
            <label for="lead-website">Website</label>
            <input type="text" id="lead-website" name="website" tabindex="-1" autocomplete="off" />
          </div>

          <div class="hero__field hero__field--full">
            <label class="hero__label" for="lead-consent">
              <input type="checkbox" id="lead-consent" name="consent_to_share" required />
              I agree that CleanWhiskers may share my request and contact details with local groomers, who may contact me by phone or email about this quote only.
            </label>
          </div>

          {# CAPTCHA widget #}
          {% if captcha_provider is defined and captcha_provider|lower != 'none' and captcha_provider|length > 0 %}
            <div class="hero__field captcha-field">
              {% if captcha_provider|lower in ['recaptcha', 'google'] %}
                <div class="g-recaptcha" data-sitekey="{{ recaptcha_site_key|default('') }}" data-theme="dark"></div>
              {% elseif captcha_provider|lower == 'hcaptcha' %}
                <div class="h-captcha" data-sitekey="{{ hcaptcha_site_key|default('') }}" data-theme="dark"></div>
              {% endif %}
            </div>
          {% endif %}

          <button type="submit" class="hero__cta btn btn--accent" aria-describedby="lead-privacy-note">Get My Free Quote</button>
          <p id="lead-privacy-note" class="hero__note">
            By submitting, you agree to our
            <a href="{{ path('app_terms') }}">Terms</a>
            and acknowledge our
            <a href="{{ path('app_privacy') }}">Privacy Policy</a>.
            {% if captcha_provider is defined and captcha_provider|lower != 'none' and captcha_provider|length > 0 %}
              {% if captcha_provider|lower in ['recaptcha', 'google'] %}
                This site is protected by reCAPTCHA and the Google
                <a href="https://policies.google.com/privacy" rel="noopener noreferrer" target="_blank">Privacy Policy</a>
                and
                <a href="https://policies.google.com/terms" rel="noopener noreferrer" target="_blank">Terms of Service</a>
                apply.
              {% elseif captcha_provider|lower == 'hcaptcha' %}
                This site is protected by hCaptcha and its
                <a href="https://www.hcaptcha.com/privacy" rel="noopener noreferrer" target="_blank">Privacy Policy</a>
                and
                <a href="https://www.hcaptcha.com/terms" rel="noopener noreferrer" target="_blank">Terms of Service</a>
                apply.
              {% endif %}
            {% endif %}
          </p>
        </form>

        <div class="hero__meta trust-symbols" aria-label="Trust indicators">
          <span class="hero__badge">✓ Vetted &amp; Insured Professionals</span>
          <span class="hero__badge">✓ Serving the {{ city.name }} Area</span>
          <span class="hero__badge">✓ Book in Minutes — No Stress</span>
        </div>
      </div>
    </section>
  </div>
  {% include 'home/partials/_benefits_section.html.twig' with { cityName: city.name } %}
  <hr class="section-divider" aria-hidden="true" />
  {% include 'home/partials/_how_it_works_section.html.twig' with { cityName: city.name } %}
  <hr class="section-divider" aria-hidden="true" />
  {% include 'home/partials/_social_proof_section.html.twig' with { cityName: city.name } %}
  <hr class="section-divider" aria-hidden="true" />
  {% include 'home/partials/_faq_section.html.twig' with { cityName: city.name, citySlug: city.slug, serviceSlug: service.slug } %}
{% endblock %}
